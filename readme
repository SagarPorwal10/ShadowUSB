# ShadowUSB: Advanced USB Forensics Tool

**ShadowUSB** is a modular digital forensics tool designed to analyze USB device history on Windows systems. It correlates data from the Windows Registry, Event Logs, and Setup API logs to reconstruct a comprehensive timeline of USB usage, user attribution, and drive letter mapping.

Designed for incident responders and forensic analysts, ShadowUSB provides a "single source of truth" report, crucial for investigations involving data exfiltration, malware entry vectors, or unauthorized device usage.

---

## ğŸš€ Key Features

* **Registry Artifact Analysis:** extracting metadata (Vendor, Product, Revision) from `HKLM\SYSTEM\CurrentControlSet\Enum\USBSTOR`.
* **Timeline Reconstruction:** Parses `setupapi.dev.log` to recover the *original* installation timestamp, often predating the Registry's "Last Write" time.
* **User Attribution (Live & Offline):**
* Scans active user sessions (`HKEY_USERS`) to link devices to specific accounts.
* **Advanced:** Mounts and scans offline `NTUSER.DAT` hives to identify users who are not currently logged in.


* **Drive Letter Mapping:** Reverse-engineers the `MountedDevices` binary blobs to identify the specific drive letter (e.g., `F:`, `G:`) assigned to a device.
* **Chain of Custody:** Automatically calculates SHA-256 hashes of all generated reports to ensure evidence integrity.
* **Dual-Format Reporting:** Generates evidence in both CSV (machine-readable) and Excel (analyst-friendly) formats.

---

## ğŸ› ï¸ Installation & Requirements

### Prerequisites

* Python 3.8+
* Administrator privileges (required to access Windows Registry and System Logs)

### Setup

1. **Clone the repository:**
```bash
git clone https://github.com/yourusername/ShadowUSB.git
cd ShadowUSB

```


2. **Install dependencies:**
```bash
pip install pandas openpyxl pyinstaller

```



---

## ğŸ“¦ Building the Executable (Portable Mode)

To run ShadowUSB on a target machine without installing Python, compile it into a standalone `.exe`:

```bash
python -m PyInstaller --onefile --name "ShadowUSB_Forensics" main.py

```

The executable will be located in the `dist/` folder. You can copy this file to a USB drive and run it on any Windows system.

---

## ğŸ’» Usage

**Note:** You must run this tool as **Administrator**.

### Running via Python

```bash
python main.py

```

### Running via Executable

Right-click `ShadowUSB_Forensics.exe` and select **"Run as Administrator"**.

---

## ğŸ“Š Output & Reports

The tool generates two evidence files in the same directory:

1. **`evidence_usb.csv`**: Raw data suitable for importing into other forensic tools (Timeline, Plaso).
2. **`evidence_usb.xlsx`**: A formatted Excel report with auto-adjusted columns for immediate review.

**Data Fields:**

* `Device Name`: Friendly name (e.g., "SanDisk Ultra").
* `Serial Number`: Unique hardware ID.
* `First Connected`: The earliest timestamp found in system logs.
* `Last Known Drive`: The drive letter (`F:`) associated with the device.
* `Associated Users`: The user account(s) that mounted the device.
* `Vendor ID`: Hardware vendor identifier.
* `Raw Registry Path`: Source key for verification.

---

## ğŸ“‚ Project Structure

```text
ShadowUSB/
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ scanner.py       # Registry extraction logic
â”‚   â”œâ”€â”€ log_parser.py    # SetupAPI log parsing
â”‚   â”œâ”€â”€ user_tracker.py  # User hive analysis (Offline/Online)
â”‚   â”œâ”€â”€ drive_mapper.py  # Binary registry parsing
â”‚   â””â”€â”€ correlator.py    # Data merging logic
â”œâ”€â”€ reports/
â”‚   â”œâ”€â”€ csv_exporter.py
â”‚   â””â”€â”€ excel_exporter.py
â”œâ”€â”€ utils/
â”‚   â””â”€â”€ user_utils.py    # SID to Username resolution
â”œâ”€â”€ main.py              # Entry point
â””â”€â”€ README.md

```

---

## âš ï¸ Disclaimer

**For Educational and Authorized Forensic Use Only.**
This tool is intended to assist in legitimate security investigations and academic research. The author is not responsible for any misuse of this tool or damage caused by its use. Always ensure you have proper authorization before analyzing a system that you do not own.

---

## ğŸ“œ License

This project is licensed under the MIT License - see the [LICENSE](https://www.google.com/search?q=LICENSE) file for details.